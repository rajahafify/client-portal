<!DOCTYPE html>
<html>
  <head>
    <title>Client Portal</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              brand: {
                500: "#615BFF",
                600: "#3D32FF"
              }
            },
            fontFamily: {
              sans: ["Inter", "-apple-system", "BlinkMacSystemFont", "Segoe UI", "sans-serif"],
              display: ["Manrope", "-apple-system", "BlinkMacSystemFont", "sans-serif"]
            }
          }
        }
      }
    </script>

    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-slate-100 font-sans text-slate-900">
    <% if controller_name == "sessions" || !user_signed_in? %>
      <div class="flex min-h-screen items-center justify-center bg-white px-4 py-12">
        <div class="w-full max-w-md rounded-[32px] border border-slate-200 bg-white px-10 py-14 shadow-[0_32px_60px_-25px_rgba(15,23,42,0.25)]">
          <%= yield %>
        </div>
      </div>
    <% else %>
      <div class="flex h-screen w-full bg-slate-100">
        <aside class="hidden h-full w-72 flex-col justify-between border border-white/40 bg-gradient-to-b from-white/70 via-white/45 to-indigo-100/40 p-6 text-slate-900 shadow-[0_40px_70px_-50px_rgba(79,70,229,0.65)] backdrop-blur-2xl lg:flex">
          <div class="space-y-8">
            <div>
              <div class="flex items-center gap-3">
                  <span class="inline-flex h-11 w-11 items-center justify-center rounded-2xl bg-indigo-500/90 text-lg font-semibold text-white shadow-lg shadow-indigo-900/20">CP</span>
                  <span class="text-sm font-semibold tracking-[0.2em] uppercase text-slate-700">Client Portal</span>
                </div>
              </div>

              <nav class="space-y-2 text-sm text-slate-600">
                <% primary_nav = [
                  { label: "Dashboard", path: clients_path, icon: "M3 7h14M3 12h14M3 17h14" },
                  { label: "My Client", path: my_client_path, icon: "M4 6h16M4 12h10M4 18h7" },
                  { label: "Documents", path: "#documents", icon: "M8 6h8M8 10h8m-8 4h5" }
                ] %>
                <% primary_nav.each do |item| %>
                  <% active = request.fullpath == item[:path] || request.fullpath.start_with?(item[:path]) %>
                  <%= link_to item[:path], class: "flex items-center gap-3 rounded-xl px-4 py-2 transition #{active ? 'bg-white/70 text-slate-900 shadow-sm shadow-indigo-500/10' : 'text-slate-600 hover:bg-white/50 hover:text-slate-900'}" do %>
                    <svg class="h-5 w-5 text-slate-500" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                      <path d="<%= item[:icon] %>" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <span class="font-medium"><%= item[:label] %></span>
                  <% end %>
                <% end %>
              </nav>

              <div class="space-y-3">
                <p class="text-xs uppercase tracking-[0.35em] text-slate-500/70">Your teams</p>
                <% ["Heroicons", "Tailwind Labs", "Workcation"].each do |team| %>
                  <div class="flex items-center gap-3 text-sm text-slate-600">
                    <span class="inline-flex size-8 items-center justify-center rounded-full bg-white/70 text-xs font-semibold text-slate-700"><%= team.first.upcase %></span>
                    <span><%= team %></span>
                  </div>
                <% end %>
              </div>
            </div>

            <div>
              <%= button_to logout_path,
                    method: :delete,
                    class: "flex w-full items-center gap-3 rounded-xl border border-white/40 bg-white/60 px-4 py-2 text-sm font-medium text-slate-700 shadow-sm transition hover:border-indigo-200 hover:bg-white/80 hover:text-indigo-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-indigo-500",
                    form: { class: "w-full" } do %>
                <span class="inline-flex items-center gap-3">
                  <svg class="h-5 w-5 text-indigo-500" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 3H5a2 2 0 00-2 2v10a2 2 0 002 2h4m5-5h-8m8 0l-2.5 2.5m2.5-2.5L13.5 7.5" />
                  </svg>
                  <span>Sign out</span>
                </span>
              <% end %>
            </div>
          </aside>

        <div class="flex flex-1 flex-col rounded-l-[36px] bg-white shadow-[0_20px_60px_-45px_rgba(15,23,42,0.55)]">
          <header class="sticky top-0 z-30 border-b border-slate-200/60 bg-white/90 backdrop-blur">
            <div class="mx-auto flex h-16 w-full max-w-7xl items-center justify-between px-6 lg:px-8">
              <div class="relative w-full max-w-sm">
                <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center text-slate-400">
                  <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M11 3a7 7 0 100 14 7 7 0 000-14zm6 14l-2-2" />
                  </svg>
                </span>
                <input type="search" placeholder="Search" class="w-full rounded-full border border-slate-200 bg-white py-2 pl-9 pr-4 text-sm text-slate-600 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30" />
              </div>
              <% if user_signed_in? %>
                <div class="hidden items-center gap-2 rounded-full border border-slate-200 bg-white/80 px-3 py-1 text-sm font-medium text-slate-700 shadow-sm lg:flex">
                  <span><%= current_user.email %></span>
                </div>
              <% end %>
            </div>
          </header>

          <main class="flex-1 overflow-y-auto bg-slate-50">
            <div class="space-y-8 pb-8 pt-0">
              <%= yield %>
            </div>
          </main>
        </div>
      </div>
    <% end %>
  </body>
</html>
